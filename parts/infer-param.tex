\section{Parametrization inference}
\resume{The second part of the translation process is to infer the Parametrization. It relies on an exhaustive enumeration of all predecessors of each gene in order to fin attractor processes. The implementation returns a possibly incomplete of all necessary parameters, given the exhaustiveness of the cooperations. The last step consists of the enumeration of all possible configurations, given this set of inferred parameters, and some constraints on the Parametrization.}

\todo{Algorithm to infer parameters}

\afaire{Revoir pour le cas avec arcs non-signés}

In this section we focus on the inference of discrete René Thomas' parameters.
Let there $\PH = (\PHs,\PHl,\PHa)$ a PH and $\IG = (\Gamma,E_+,E_-)$ a BRN (it is possible to use a BRN inferred using the method of the previous section).
Let $K_{a,A,B}$ be the parameter we want to infer, for a given component $a \in \Gamma$, and $A
\subset \PHpredecgene{b}$ (resp. $B \subset \PHpredecgene{b}$) a set of activators (resp.
inhibitors) in the regulators of $a$. This inference, as for the Interaction Graph inference, relies
on the search of focal processes of the component for the given configuration of its regulators.

For each sort $b \in \PHpredecgene{a}$, we define a context $C^b_{a,A,B}$ in
(\ref{eq:param_context}) that contains all processes representing the influence of the regulators in
the configuration $A,B$. The context of a cooperative sort $\upsilon \in \PHs\setminus\Gamma$ that
regulates $a$ is given in (\ref{eq:param_context_coop}) as the set of processes that represent the
given configuration.
\todo{define $\PHsort(\upsilon)$ - maybe in section 3.2}
\begin{align}
\label{eq:param_context}
\forall b\in\Gamma,~
C_{a,A,B}^b & = \begin{cases}
\levelsA{b}{a} & \text{if $b \in A$,}\\
\levelsI{b}{a} & \text{if $b \in B$,}\\
L_a		& \text{otherwise;}\\
\end{cases}
\\
\label{eq:param_context_coop}
\forall \upsilon \in \PHpredec{a}\setminus\Gamma,~
C_{a,A,B}^\upsilon & = \{
%\textstyle
\upsilon[\sigma] \mid \sigma \in \textstyle\prod_{b \in \PHsort(\upsilon)}C_{a,A,B}^b \}
\enspace.
\end{align}

\begin{comment}
We pose $\PHh_{b,A,B}$ (\eqref{eq:param_h}) the set of actions in $\PHh$ that hit a process of sort $b$ and can be fired in the previously defined context. A process of sort $b$ can be reached if it belongs to the context or if it is a bounce in $\PHh_{b,A,B}$; we call $L_{b,A,B}^?$ (\ref{eq:param_candidates}) the set of such candidates. The set of focal processes $L_{b,A,B}^*$ (\ref{eq:param_focal}) is the set of processes of $L_{b,A,B}^?$ that are not hit by an action in $\PHh_{b,A,B}$.
\begin{align}
\label{eq:param_h}
  \PHh_{b,A,B} & = \{ \PHfrappe{a_i}{b_j}{b_k} \in \PHh \mid \exists a \in \Gamma, a_i \in C_{b,A,B}^a \wedge b_j \in C_{b,A,B}^b\}
\\
\label{eq:param_candidates}
  L_{b,A,B}^? & =  C_{b,A,B}^b \cup \{ b_k\mid \exists \PHfrappe{a_i}{b_j}{b_k} \in \PHh_{b,A,B}\}
\\
\label{eq:param_focal}
  L_{b,A,B}^* & =  L_{b,A,B}^? \setminus \{ b_j \mid \exists \PHfrappe{a_i}{b_j}{b_k} \in \PHh_{b,A,B} \}
\end{align}

The focal processes in $L_{b,A,B}^*$ are the wanted parameters if they are attractors, \ie if the actions in $\PHh_{b,A,B}$ can only bounce in their direction. A set of processes is an attractor if it verifies the condition (\ref{eq:param_attractor}); in this case, this set of processes is also an interval.
\begin{align}
\label{eq:param_attractor}
  \forall \PHfrappe{b_i}{a_j}{a_k} \in \PHh_{a,A,B}, \forall a_f \in L_{a,A,B}^*, |f-k| < |f-j|
\end{align}
\end{comment}

\todo{relate $K$ to $\focals$ \pref{thm:param_K}}

\begin{theorem}[Parameter inference]
\label{thm:param_K}
Let $(\PHs, \PHl, \PHh)$ be a Process Hitting well-defined for IG inference, and $\IG = (\Gamma,
E_+, E_-)$ the inferred IG with $E_+\cap E_-=\emptyset$.
Let $A$ (resp. $B$) $\subseteq \Gamma$ be the set of regulators that activate (resp. inhibit) a sort
$b$.
If $\focals(a,C^a_{a,A,B},C_{a,A,B})$ is a non-empty interval, 
	then $K_{a,A,B} = \focals(a, C^a_{a,A,B}, C_{a,A,B})$,
	where $C_{a,A,B} = \bigcup_{b\in\PHpredec{a}} C^b_{a,A,B}$.
\end{theorem}

\todo{Illustrate with the example}

\todo{Discuss of incomplete cooperations $\Rightarrow$ inconclusive cases}
Given the \pref{thm:param_K}, we see that in some cases, the inference of the desired parameter is impossible. This can be due to a lack of cooperation between regulators: when two regulators independently hit a component, their actions can have opposite effects, leading to either an indeterministic evolution or to oscillations. Such an indeterminism is not possible in a GRN as in a given configuration of regulators, a component can have only an interval attractor, and eventually reaches a steady-state. In order to avoid such inconclusive cases, one has to ensure that no such behavior is allowed by either removing undesired actions or using cooperative sorts to avoid opposite influences between regulators of a component.

\todo{Enumerate all possible parametrizations}
When building a BRN, one has to find the parametrization that best describes the desired behavior of the studied system. Complexity is inherent to this process as the number of possible parametrizations for a given IG is exponential w.r.t. the number of components. However, the method of parameters inference presented in this section gives some information about necessary parameters given a certain dynamics described by a PH. This information thus drops the number of possible parametrizations, allowing to find the desired behavior more easily. The last step of our method is to enumerate all possible parametrizations regarding the results of the parameters inference and some biological constraints found in \cite{BernotSemBRN}. In the following, we define these constraints and the notion of admissible parametrization of an IG with respect to the results of parameters inference.

We propose three constraints that allow to reduce the number of possible parametrizations.

\begin{property}[Extreme values assumption]
\todo{À voir si on ne l'inclut pas dans la définition de GRN}
Let $\IG = (\Gamma, E_+, E_-)$ be an IG. A parametrization $K$ on $\IG$ satisfies the \emph{extreme values assumption} iff:
\label{prop:param_enum_extreme}
\[
  \forall b \in \Gamma, \PHpredecgene{b} \neq \emptyset \Rightarrow K_{b,\emptyset,\PHpredecgene{b}} = 0 \wedge K_{b,\PHpredecgene{b},\emptyset} = l_b
\]
\end{property}

\begin{property}[Activity assumption]
\label{prop:param_enum_activity}
Let $\IG = (\Gamma, E_+, E_-)$ be an IG. A parametrization $K$ on $\IG$ satisfies the \emph{activity assumption} iff:
\begin{align*}
  \forall b \in \Gamma, \forall a \in \PHpredecgene{b}^+, \exists A \subset \PHpredecgene{b}^+, \exists B \subset \PHpredecgene{b}^+,
    K_{b,A \cup \{b\},B} > K_{b,A,B}
\\
  \forall b \in \Gamma, \forall a \in \PHpredecgene{b}^-, \exists A \subset \PHpredecgene{b}^+, \exists B \subset \PHpredecgene{b}^+,
    K_{b,A,B \cup \{b\}} < K_{b,A,B}
\end{align*}
\end{property}

\begin{property}[Monotonicity assumption]
\label{prop:param_enum_monotonicity}
Let $\IG = (\Gamma, E_+, E_-)$ be an IG. A parametrization $K$ on $\IG$ satisfies the \emph{monotonicity assumption} iff:
\begin{align*}
  \forall b \in \Gamma, \forall A, A' \in \PHpredecgene{b}^+, &\forall B, B' \in \PHpredecgene{b}^-,
\\
  &A \subset A' \wedge B \subset B' \Rightarrow K_{b,A,B} < K_{b,A',B'}
\end{align*}
\end{property}

\begin{definition}[Admissible parametrization]
Let $\IG = (\Gamma, E_+, E_-)$ be an IG. A parametrization $K$ on $\IG$ is said to be admissible iff it respects the extreme values assumption, the activity assumption and the monotonicity assumption.
\end{definition}

\begin{definition}[Admissible parametrization with respect to inferred parameters]
\label{prop:param_enum_inf}
Let $\PH = (\PHs, \PHl, \PHh)$ be a PH so that IG inference is possible, and $\IG = (\Gamma, E_+,
E_-)$ the inferred IG. A parametrization $K$ on $\IG$ is said to be admissible with respect to the
inferred parameters iff it is admissible and that all parameters that can be inferred regarding
theorem (\ref{thm:param_K}) are equal to their inferred value.
\end{definition}



